/* view source at github.com/mcous/svgerber */
(function(){function camelCase(s){return s.toLowerCase().replace(/-(.)/g,function(m,g){return g.toUpperCase()})}function fullHex(hex){return 4==hex.length?["#",hex.substring(1,2),hex.substring(1,2),hex.substring(2,3),hex.substring(2,3),hex.substring(3,4),hex.substring(3,4)].join(""):hex}function compToHex(comp){var hex=comp.toString(16);return 1==hex.length?"0"+hex:hex}function proportionalSize(box,width,height){return(null==width||null==height)&&(null==height?height=box.height/box.width*width:null==width&&(width=box.width/box.height*height)),{width:width,height:height}}function at(o,pos){return"number"==typeof o.from?o.from+(o.to-o.from)*pos:o instanceof SVG.Color||o instanceof SVG.Number?o.at(pos):1>pos?o.from:o.to}function arrayToString(a){for(var i=0,il=a.length,s="";il>i;i++)s+=a[i][0],null!=a[i][1]&&(s+=a[i][1],null!=a[i][2]&&(s+=" ",s+=a[i][2],null!=a[i][3]&&(s+=" ",s+=a[i][3],s+=" ",s+=a[i][4],null!=a[i][5]&&(s+=" ",s+=a[i][5],s+=" ",s+=a[i][6],null!=a[i][7]&&(s+=" ",s+=a[i][7])))));return s+" "}function boxProperties(b){b.x2=b.x+b.width,b.y2=b.y+b.height,b.cx=b.x+b.width/2,b.cy=b.y+b.height/2}function parseMatrix(o){if(o.matrix){var m=o.matrix.replace(/\s/g,"").split(",");6==m.length&&(o.a=parseFloat(m[0]),o.b=parseFloat(m[1]),o.c=parseFloat(m[2]),o.d=parseFloat(m[3]),o.e=parseFloat(m[4]),o.f=parseFloat(m[5]))}return o}var SVG=this.SVG=function(element){return SVG.supported?(element=new SVG.Doc(element),SVG.parser||SVG.prepare(element),element):void 0};if(SVG.ns="http://www.w3.org/2000/svg",SVG.xmlns="http://www.w3.org/2000/xmlns/",SVG.xlink="http://www.w3.org/1999/xlink",SVG.did=1e3,SVG.eid=function(name){return"Svgjs"+name.charAt(0).toUpperCase()+name.slice(1)+SVG.did++},SVG.create=function(name){var element=document.createElementNS(this.ns,name);return element.setAttribute("id",this.eid(name)),element},SVG.extend=function(){var modules,methods,key,i;for(modules=[].slice.call(arguments),methods=modules.pop(),i=modules.length-1;i>=0;i--)if(modules[i])for(key in methods)modules[i].prototype[key]=methods[key];SVG.Set&&SVG.Set.inherit&&SVG.Set.inherit()},SVG.get=function(id){var node=document.getElementById(id);return node?node.instance:void 0},SVG.prepare=function(element){var body=document.getElementsByTagName("body")[0],draw=(body?new SVG.Doc(body):element.nested()).size(2,0),path=SVG.create("path");draw.node.appendChild(path),SVG.parser={body:body||element.parent,draw:draw.style("opacity:0;position:fixed;left:100%;top:100%;overflow:hidden"),poly:draw.polyline().node,path:path}},SVG.supported=function(){return!!document.createElementNS&&!!document.createElementNS(SVG.ns,"svg").createSVGRect}(),!SVG.supported)return!1;SVG.invent=function(config){var initializer="function"==typeof config.create?config.create:function(){this.constructor.call(this,SVG.create(config.create))};return config.inherit&&(initializer.prototype=new config.inherit),config.extend&&SVG.extend(initializer,config.extend),config.construct&&SVG.extend(config.parent||SVG.Container,config.construct),initializer},SVG.regex={unit:/^(-?[\d\.]+)([a-z%]{0,2})$/,hex:/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,rgb:/rgb\((\d+),(\d+),(\d+)\)/,isHex:/^#[a-f0-9]{3,6}$/i,isRgb:/^rgb\(/,isCss:/[^:]+:[^;]+;?/,isBlank:/^(\s+)?$/,isNumber:/^-?[\d\.]+$/,isPercent:/^-?[\d\.]+%$/,isImage:/\.(jpg|jpeg|png|gif)(\?[^=]+.*)?/i,isEvent:/^[\w]+:[\w]+$/},SVG.defaults={matrix:"1 0 0 1 0 0",attrs:{"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,"stroke-linejoin":"miter","stroke-linecap":"butt",fill:"#000000",stroke:"#000000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0,"stop-opacity":1,"stop-color":"#000000","font-size":16,"font-family":"Helvetica, Arial, sans-serif","text-anchor":"start"},trans:function(){return{x:0,y:0,scaleX:1,scaleY:1,rotation:0,skewX:0,skewY:0,matrix:this.matrix,a:1,b:0,c:0,d:1,e:0,f:0}}},SVG.Color=function(color){var match;this.r=0,this.g=0,this.b=0,"string"==typeof color?SVG.regex.isRgb.test(color)?(match=SVG.regex.rgb.exec(color.replace(/\s/g,"")),this.r=parseInt(match[1]),this.g=parseInt(match[2]),this.b=parseInt(match[3])):SVG.regex.isHex.test(color)&&(match=SVG.regex.hex.exec(fullHex(color)),this.r=parseInt(match[1],16),this.g=parseInt(match[2],16),this.b=parseInt(match[3],16)):"object"==typeof color&&(this.r=color.r,this.g=color.g,this.b=color.b)},SVG.extend(SVG.Color,{toString:function(){return this.toHex()},toHex:function(){return"#"+compToHex(this.r)+compToHex(this.g)+compToHex(this.b)},toRgb:function(){return"rgb("+[this.r,this.g,this.b].join()+")"},brightness:function(){return this.r/255*.3+this.g/255*.59+this.b/255*.11},morph:function(color){return this.destination=new SVG.Color(color),this},at:function(pos){return this.destination?(pos=0>pos?0:pos>1?1:pos,new SVG.Color({r:~~(this.r+(this.destination.r-this.r)*pos),g:~~(this.g+(this.destination.g-this.g)*pos),b:~~(this.b+(this.destination.b-this.b)*pos)})):this}}),SVG.Color.test=function(color){return color+="",SVG.regex.isHex.test(color)||SVG.regex.isRgb.test(color)},SVG.Color.isRgb=function(color){return color&&"number"==typeof color.r&&"number"==typeof color.g&&"number"==typeof color.b},SVG.Color.isColor=function(color){return SVG.Color.isRgb(color)||SVG.Color.test(color)},SVG.Array=function(array,fallback){array=(array||[]).valueOf(),0==array.length&&fallback&&(array=fallback.valueOf()),this.value=this.parse(array)},SVG.extend(SVG.Array,{morph:function(array){if(this.destination=this.parse(array),this.value.length!=this.destination.length){for(var lastValue=this.value[this.value.length-1],lastDestination=this.destination[this.destination.length-1];this.value.length>this.destination.length;)this.destination.push(lastDestination);for(;this.value.length<this.destination.length;)this.value.push(lastValue)}return this},settle:function(){for(var i=0,il=this.value.length,seen=[];il>i;i++)-1==seen.indexOf(this.value[i])&&seen.push(this.value[i]);return this.value=seen},at:function(pos){if(!this.destination)return this;for(var i=0,il=this.value.length,array=[];il>i;i++)array.push(this.value[i]+(this.destination[i]-this.value[i])*pos);return new SVG.Array(array)},toString:function(){return this.value.join(" ")},valueOf:function(){return this.value},parse:function(array){return array=array.valueOf(),Array.isArray(array)?array:this.split(array)},split:function(string){return string.replace(/\s+/g," ").replace(/^\s+|\s+$/g,"").split(" ")},reverse:function(){return this.value.reverse(),this}}),SVG.PointArray=function(){this.constructor.apply(this,arguments)},SVG.PointArray.prototype=new SVG.Array,SVG.extend(SVG.PointArray,{toString:function(){for(var i=0,il=this.value.length,array=[];il>i;i++)array.push(this.value[i].join(","));return array.join(" ")},at:function(pos){if(!this.destination)return this;for(var i=0,il=this.value.length,array=[];il>i;i++)array.push([this.value[i][0]+(this.destination[i][0]-this.value[i][0])*pos,this.value[i][1]+(this.destination[i][1]-this.value[i][1])*pos]);return new SVG.PointArray(array)},parse:function(array){if(array=array.valueOf(),Array.isArray(array))return array;array=this.split(array);for(var p,i=0,il=array.length,points=[];il>i;i++)p=array[i].split(","),points.push([parseFloat(p[0]),parseFloat(p[1])]);return points},move:function(x,y){var box=this.bbox();if(x-=box.x,y-=box.y,!isNaN(x)&&!isNaN(y))for(var i=this.value.length-1;i>=0;i--)this.value[i]=[this.value[i][0]+x,this.value[i][1]+y];return this},size:function(width,height){var i,box=this.bbox();for(i=this.value.length-1;i>=0;i--)this.value[i][0]=(this.value[i][0]-box.x)*width/box.width+box.x,this.value[i][1]=(this.value[i][1]-box.y)*height/box.height+box.y;return this},bbox:function(){return SVG.parser.poly.setAttribute("points",this.toString()),SVG.parser.poly.getBBox()}}),SVG.PathArray=function(array,fallback){this.constructor.call(this,array,fallback)},SVG.PathArray.prototype=new SVG.Array,SVG.extend(SVG.PathArray,{toString:function(){return arrayToString(this.value)},move:function(x,y){var box=this.bbox();if(x-=box.x,y-=box.y,!isNaN(x)&&!isNaN(y))for(var l,i=this.value.length-1;i>=0;i--)l=this.value[i][0],"M"==l||"L"==l||"T"==l?(this.value[i][1]+=x,this.value[i][2]+=y):"H"==l?this.value[i][1]+=x:"V"==l?this.value[i][1]+=y:"C"==l||"S"==l||"Q"==l?(this.value[i][1]+=x,this.value[i][2]+=y,this.value[i][3]+=x,this.value[i][4]+=y,"C"==l&&(this.value[i][5]+=x,this.value[i][6]+=y)):"A"==l&&(this.value[i][6]+=x,this.value[i][7]+=y);return this},size:function(width,height){var i,l,box=this.bbox();for(i=this.value.length-1;i>=0;i--)l=this.value[i][0],"M"==l||"L"==l||"T"==l?(this.value[i][1]=(this.value[i][1]-box.x)*width/box.width+box.x,this.value[i][2]=(this.value[i][2]-box.y)*height/box.height+box.y):"H"==l?this.value[i][1]=(this.value[i][1]-box.x)*width/box.width+box.x:"V"==l?this.value[i][1]=(this.value[i][1]-box.y)*height/box.height+box.y:"C"==l||"S"==l||"Q"==l?(this.value[i][1]=(this.value[i][1]-box.x)*width/box.width+box.x,this.value[i][2]=(this.value[i][2]-box.y)*height/box.height+box.y,this.value[i][3]=(this.value[i][3]-box.x)*width/box.width+box.x,this.value[i][4]=(this.value[i][4]-box.y)*height/box.height+box.y,"C"==l&&(this.value[i][5]=(this.value[i][5]-box.x)*width/box.width+box.x,this.value[i][6]=(this.value[i][6]-box.y)*height/box.height+box.y)):"A"==l&&(this.value[i][1]=this.value[i][1]*width/box.width,this.value[i][2]=this.value[i][2]*height/box.height,this.value[i][6]=(this.value[i][6]-box.x)*width/box.width+box.x,this.value[i][7]=(this.value[i][7]-box.y)*height/box.height+box.y);return this},parse:function(array){if(array instanceof SVG.PathArray)return array.valueOf();var i,il,x0,y0,x1,y1,x2,y2,s,seg,segs,x=0,y=0;for(SVG.parser.path.setAttribute("d","string"==typeof array?array:arrayToString(array)),segs=SVG.parser.path.pathSegList,i=0,il=segs.numberOfItems;il>i;++i)seg=segs.getItem(i),s=seg.pathSegTypeAsLetter,"M"==s||"L"==s||"H"==s||"V"==s||"C"==s||"S"==s||"Q"==s||"T"==s||"A"==s?("x"in seg&&(x=seg.x),"y"in seg&&(y=seg.y)):("x1"in seg&&(x1=x+seg.x1),"x2"in seg&&(x2=x+seg.x2),"y1"in seg&&(y1=y+seg.y1),"y2"in seg&&(y2=y+seg.y2),"x"in seg&&(x+=seg.x),"y"in seg&&(y+=seg.y),"m"==s?segs.replaceItem(SVG.parser.path.createSVGPathSegMovetoAbs(x,y),i):"l"==s?segs.replaceItem(SVG.parser.path.createSVGPathSegLinetoAbs(x,y),i):"h"==s?segs.replaceItem(SVG.parser.path.createSVGPathSegLinetoHorizontalAbs(x),i):"v"==s?segs.replaceItem(SVG.parser.path.createSVGPathSegLinetoVerticalAbs(y),i):"c"==s?segs.replaceItem(SVG.parser.path.createSVGPathSegCurvetoCubicAbs(x,y,x1,y1,x2,y2),i):"s"==s?segs.replaceItem(SVG.parser.path.createSVGPathSegCurvetoCubicSmoothAbs(x,y,x2,y2),i):"q"==s?segs.replaceItem(SVG.parser.path.createSVGPathSegCurvetoQuadraticAbs(x,y,x1,y1),i):"t"==s?segs.replaceItem(SVG.parser.path.createSVGPathSegCurvetoQuadraticSmoothAbs(x,y),i):"a"==s?segs.replaceItem(SVG.parser.path.createSVGPathSegArcAbs(x,y,seg.r1,seg.r2,seg.angle,seg.largeArcFlag,seg.sweepFlag),i):("z"==s||"Z"==s)&&(x=x0,y=y0)),("M"==s||"m"==s)&&(x0=x,y0=y);for(array=[],segs=SVG.parser.path.pathSegList,i=0,il=segs.numberOfItems;il>i;++i)seg=segs.getItem(i),s=seg.pathSegTypeAsLetter,x=[s],"M"==s||"L"==s||"T"==s?x.push(seg.x,seg.y):"H"==s?x.push(seg.x):"V"==s?x.push(seg.y):"C"==s?x.push(seg.x1,seg.y1,seg.x2,seg.y2,seg.x,seg.y):"S"==s?x.push(seg.x2,seg.y2,seg.x,seg.y):"Q"==s?x.push(seg.x1,seg.y1,seg.x,seg.y):"A"==s&&x.push(seg.r1,seg.r2,seg.angle,0|seg.largeArcFlag,0|seg.sweepFlag,seg.x,seg.y),array.push(x);return array},bbox:function(){return SVG.parser.path.setAttribute("d",this.toString()),SVG.parser.path.getBBox()}}),SVG.Number=function(value){if(this.value=0,this.unit="","number"==typeof value)this.value=isNaN(value)?0:isFinite(value)?value:0>value?-3.4e38:3.4e38;else if("string"==typeof value){var match=value.match(SVG.regex.unit);match&&(this.value=parseFloat(match[1]),"%"==match[2]?this.value/=100:"s"==match[2]&&(this.value*=1e3),this.unit=match[2])}else value instanceof SVG.Number&&(this.value=value.value,this.unit=value.unit)},SVG.extend(SVG.Number,{toString:function(){return("%"==this.unit?~~(1e8*this.value)/1e6:"s"==this.unit?this.value/1e3:this.value)+this.unit},valueOf:function(){return this.value},plus:function(number){return this.value=this+new SVG.Number(number),this},minus:function(number){return this.plus(-new SVG.Number(number))},times:function(number){return this.value=this*new SVG.Number(number),this},divide:function(number){return this.value=this/new SVG.Number(number),this},to:function(unit){return"string"==typeof unit&&(this.unit=unit),this},morph:function(number){return this.destination=new SVG.Number(number),this},at:function(pos){return this.destination?new SVG.Number(this.destination).minus(this).times(pos).plus(this):this}}),SVG.ViewBox=function(element){var x,y,width,height,wm=1,hm=1,box=element.bbox(),view=(element.attr("viewBox")||"").match(/-?[\d\.]+/g);for(width=new SVG.Number(element.width()),height=new SVG.Number(element.height());"%"==width.unit;)wm*=width.value,width=new SVG.Number(element instanceof SVG.Doc?element.parent.offsetWidth:element.width());for(;"%"==height.unit;)hm*=height.value,height=new SVG.Number(element instanceof SVG.Doc?element.parent.offsetHeight:element.height());this.x=box.x,this.y=box.y,this.width=width*wm,this.height=height*hm,this.zoom=1,view&&(x=parseFloat(view[0]),y=parseFloat(view[1]),width=parseFloat(view[2]),height=parseFloat(view[3]),this.zoom=this.width/this.height>width/height?this.height/height:this.width/width,this.x=x,this.y=y,this.width=width,this.height=height)},SVG.extend(SVG.ViewBox,{toString:function(){return this.x+" "+this.y+" "+this.width+" "+this.height}}),SVG.BBox=function(element){var box;if(this.x=0,this.y=0,this.width=0,this.height=0,element){try{box=element.node.getBBox()}catch(e){box={x:element.node.clientLeft,y:element.node.clientTop,width:element.node.clientWidth,height:element.node.clientHeight}}this.x=box.x+element.trans.x,this.y=box.y+element.trans.y,this.width=box.width*element.trans.scaleX,this.height=box.height*element.trans.scaleY}boxProperties(this)},SVG.extend(SVG.BBox,{merge:function(box){var b=new SVG.BBox;return b.x=Math.min(this.x,box.x),b.y=Math.min(this.y,box.y),b.width=Math.max(this.x+this.width,box.x+box.width)-b.x,b.height=Math.max(this.y+this.height,box.y+box.height)-b.y,boxProperties(b),b}}),SVG.RBox=function(element){var e,zoom,box={};if(this.x=0,this.y=0,this.width=0,this.height=0,element){for(e=element.doc().parent,zoom=element.doc().viewbox().zoom,box=element.node.getBoundingClientRect(),this.x=box.left,this.y=box.top,this.x-=e.offsetLeft,this.y-=e.offsetTop;e=e.offsetParent;)this.x-=e.offsetLeft,this.y-=e.offsetTop;for(e=element;e=e.parent;)"svg"==e.type&&e.viewbox&&(zoom*=e.viewbox().zoom,this.x-=e.x()||0,this.y-=e.y()||0)}this.x/=zoom,this.y/=zoom,this.width=box.width/=zoom,this.height=box.height/=zoom,this.x+=window.scrollX,this.y+=window.scrollY,boxProperties(this)},SVG.extend(SVG.RBox,{merge:function(box){var b=new SVG.RBox;return b.x=Math.min(this.x,box.x),b.y=Math.min(this.y,box.y),b.width=Math.max(this.x+this.width,box.x+box.width)-b.x,b.height=Math.max(this.y+this.height,box.y+box.height)-b.y,boxProperties(b),b}}),SVG.Element=SVG.invent({create:function(node){this._stroke=SVG.defaults.attrs.stroke,this.trans=SVG.defaults.trans(),(this.node=node)&&(this.type=node.nodeName,this.node.instance=this)},extend:{x:function(x){return null!=x&&(x=new SVG.Number(x),x.value/=this.trans.scaleX),this.attr("x",x)},y:function(y){return null!=y&&(y=new SVG.Number(y),y.value/=this.trans.scaleY),this.attr("y",y)},cx:function(x){return null==x?this.x()+this.width()/2:this.x(x-this.width()/2)},cy:function(y){return null==y?this.y()+this.height()/2:this.y(y-this.height()/2)},move:function(x,y){return this.x(x).y(y)},center:function(x,y){return this.cx(x).cy(y)},width:function(width){return this.attr("width",width)},height:function(height){return this.attr("height",height)},size:function(width,height){var p=proportionalSize(this.bbox(),width,height);return this.attr({width:new SVG.Number(p.width),height:new SVG.Number(p.height)})},clone:function(){var clone,attr,type=this.type;return clone="rect"==type||"ellipse"==type?this.parent[type](0,0):"line"==type?this.parent[type](0,0,0,0):"image"==type?this.parent[type](this.src):"text"==type?this.parent[type](this.content):"path"==type?this.parent[type](this.attr("d")):"polyline"==type||"polygon"==type?this.parent[type](this.attr("points")):"g"==type?this.parent.group():this.parent[type](),attr=this.attr(),delete attr.id,clone.attr(attr),clone.trans=this.trans,clone.transform({})},remove:function(){return this.parent&&this.parent.removeElement(this),this},replace:function(element){return this.after(element).remove(),element},addTo:function(parent){return parent.put(this)},putIn:function(parent){return parent.add(this)},doc:function(type){return this._parent(type||SVG.Doc)},attr:function(a,v,n){if(null==a){for(a={},v=this.node.attributes,n=v.length-1;n>=0;n--)a[v[n].nodeName]=SVG.regex.isNumber.test(v[n].nodeValue)?parseFloat(v[n].nodeValue):v[n].nodeValue;return a}if("object"==typeof a)for(v in a)this.attr(v,a[v]);else if(null===v)this.node.removeAttribute(a);else{if(null==v)return v=this.node.getAttribute(a),null==v?SVG.defaults.attrs[a]:SVG.regex.isNumber.test(v)?parseFloat(v):v;if("style"==a)return this.style(v);"stroke-width"==a?this.attr("stroke",parseFloat(v)>0?this._stroke:null):"stroke"==a&&(this._stroke=v),("fill"==a||"stroke"==a)&&(SVG.regex.isImage.test(v)&&(v=this.doc().defs().image(v,0,0)),v instanceof SVG.Image&&(v=this.doc().defs().pattern(0,0,function(){this.add(v)}))),"number"==typeof v?v=new SVG.Number(v):SVG.Color.isColor(v)?v=new SVG.Color(v):Array.isArray(v)&&(v=new SVG.Array(v)),"leading"==a?this.leading&&this.leading(v):"string"==typeof n?this.node.setAttributeNS(n,a,v.toString()):this.node.setAttribute(a,v.toString()),!this.rebuild||"font-size"!=a&&"x"!=a||this.rebuild(a,v)}return this},transform:function(o,v){if(0==arguments.length)return this.trans;if("string"==typeof o){if(arguments.length<2)return this.trans[o];var transform={};return transform[o]=v,this.transform(transform)}var transform=[];o=parseMatrix(o);for(v in o)null!=o[v]&&(this.trans[v]=o[v]);return this.trans.matrix=this.trans.a+" "+this.trans.b+" "+this.trans.c+" "+this.trans.d+" "+this.trans.e+" "+this.trans.f,o=this.trans,o.matrix!=SVG.defaults.matrix&&transform.push("matrix("+o.matrix+")"),0!=o.rotation&&transform.push("rotate("+o.rotation+" "+(null==o.cx?this.bbox().cx:o.cx)+" "+(null==o.cy?this.bbox().cy:o.cy)+")"),(1!=o.scaleX||1!=o.scaleY)&&transform.push("scale("+o.scaleX+" "+o.scaleY+")"),0!=o.skewX&&transform.push("skewX("+o.skewX+")"),0!=o.skewY&&transform.push("skewY("+o.skewY+")"),(0!=o.x||0!=o.y)&&transform.push("translate("+new SVG.Number(o.x/o.scaleX)+" "+new SVG.Number(o.y/o.scaleY)+")"),0==transform.length?this.node.removeAttribute("transform"):this.node.setAttribute("transform",transform.join(" ")),this},style:function(s,v){if(0==arguments.length)return this.node.style.cssText||"";if(arguments.length<2)if("object"==typeof s)for(v in s)this.style(v,s[v]);else{if(!SVG.regex.isCss.test(s))return this.node.style[camelCase(s)];s=s.split(";");for(var i=0;i<s.length;i++)v=s[i].split(":"),this.style(v[0].replace(/\s+/g,""),v[1])}else this.node.style[camelCase(s)]=null===v||SVG.regex.isBlank.test(v)?"":v;return this},bbox:function(){return new SVG.BBox(this)},rbox:function(){return new SVG.RBox(this)},inside:function(x,y){var box=this.bbox();return x>box.x&&y>box.y&&x<box.x+box.width&&y<box.y+box.height},show:function(){return this.style("display","")},hide:function(){return this.style("display","none")},visible:function(){return"none"!=this.style("display")},toString:function(){return this.attr("id")},classes:function(){var classAttr=this.node.getAttribute("class");return null===classAttr?[]:classAttr.trim().split(/\s+/)},hasClass:function(className){return-1!=this.classes().indexOf(className)},addClass:function(className){var classArray;return this.hasClass(className)||(classArray=this.classes(),classArray.push(className),this.node.setAttribute("class",classArray.join(" "))),this},removeClass:function(className){var classArray;return this.hasClass(className)&&(classArray=this.classes().filter(function(c){return c!=className}),this.node.setAttribute("class",classArray.join(" "))),this},toggleClass:function(className){return this.hasClass(className)?this.removeClass(className):this.addClass(className),this},_parent:function(parent){for(var element=this;null!=element&&!(element instanceof parent);)element=element.parent;return element}}}),SVG.Parent=SVG.invent({create:function(element){this.constructor.call(this,element)},inherit:SVG.Element,extend:{children:function(){return this._children||(this._children=[])},add:function(element,i){return this.has(element)||(i=null==i?this.children().length:i,element.parent&&element.parent.children().splice(element.parent.index(element),1),this.children().splice(i,0,element),this.node.insertBefore(element.node,this.node.childNodes[i]||null),element.parent=this),this._defs&&(this.node.removeChild(this._defs.node),this.node.appendChild(this._defs.node)),this},put:function(element,i){return this.add(element,i),element},has:function(element){return this.index(element)>=0},index:function(element){return this.children().indexOf(element)},get:function(i){return this.children()[i]},first:function(){return this.children()[0]},last:function(){return this.children()[this.children().length-1]},each:function(block,deep){var i,il,children=this.children();for(i=0,il=children.length;il>i;i++)children[i]instanceof SVG.Element&&block.apply(children[i],[i,children]),deep&&children[i]instanceof SVG.Container&&children[i].each(block,deep);return this},removeElement:function(element){return this.children().splice(this.index(element),1),this.node.removeChild(element.node),element.parent=null,this},clear:function(){for(var i=this.children().length-1;i>=0;i--)this.removeElement(this.children()[i]);return this._defs&&this._defs.clear(),this},defs:function(){return this.doc().defs()}}}),SVG.Container=SVG.invent({create:function(element){this.constructor.call(this,element)},inherit:SVG.Parent,extend:{viewbox:function(v){return 0==arguments.length?new SVG.ViewBox(this):(v=1==arguments.length?[v.x,v.y,v.width,v.height]:[].slice.call(arguments),this.attr("viewBox",v))}}}),SVG.FX=SVG.invent({create:function(element){this.target=element},extend:{animate:function(d,ease,delay){var akeys,tkeys,skeys,key,element=this.target,fx=this;return"object"==typeof d&&(delay=d.delay,ease=d.ease,d=d.duration),d="="==d?d:null==d?1e3:new SVG.Number(d).valueOf(),ease=ease||"<>",fx.to=function(pos){var i;if(pos=0>pos?0:pos>1?1:pos,null==akeys){akeys=[];for(key in fx.attrs)akeys.push(key);if(element.morphArray&&(fx._plot||akeys.indexOf("points")>-1)){var box,p=new element.morphArray(fx._plot||fx.attrs.points||element.array);fx._size&&p.size(fx._size.width.to,fx._size.height.to),box=p.bbox(),fx._x?p.move(fx._x.to,box.y):fx._cx&&p.move(fx._cx.to-box.width/2,box.y),box=p.bbox(),fx._y?p.move(box.x,fx._y.to):fx._cy&&p.move(box.x,fx._cy.to-box.height/2),delete fx._x,delete fx._y,delete fx._cx,delete fx._cy,delete fx._size,fx._plot=element.array.morph(p)}}if(null==tkeys){tkeys=[];for(key in fx.trans)tkeys.push(key)}if(null==skeys){skeys=[];for(key in fx.styles)skeys.push(key)}for(pos="<>"==ease?-Math.cos(pos*Math.PI)/2+.5:">"==ease?Math.sin(pos*Math.PI/2):"<"==ease?-Math.cos(pos*Math.PI/2)+1:"-"==ease?pos:"function"==typeof ease?ease(pos):pos,fx._plot?element.plot(fx._plot.at(pos)):(fx._x?element.x(fx._x.at(pos)):fx._cx&&element.cx(fx._cx.at(pos)),fx._y?element.y(fx._y.at(pos)):fx._cy&&element.cy(fx._cy.at(pos)),fx._size&&element.size(fx._size.width.at(pos),fx._size.height.at(pos))),fx._viewbox&&element.viewbox(fx._viewbox.x.at(pos),fx._viewbox.y.at(pos),fx._viewbox.width.at(pos),fx._viewbox.height.at(pos)),fx._leading&&element.leading(fx._leading.at(pos)),i=akeys.length-1;i>=0;i--)element.attr(akeys[i],at(fx.attrs[akeys[i]],pos));for(i=tkeys.length-1;i>=0;i--)element.transform(tkeys[i],at(fx.trans[tkeys[i]],pos));for(i=skeys.length-1;i>=0;i--)element.style(skeys[i],at(fx.styles[skeys[i]],pos));fx._during&&fx._during.call(element,pos,function(from,to){return at({from:from,to:to},pos)})},"number"==typeof d&&(this.timeout=setTimeout(function(){var start=(new Date).getTime();fx.situation={interval:1e3/60,start:start,play:!0,finish:start+d,duration:d},fx.render=function(){if(fx.situation.play===!0){var time=(new Date).getTime(),pos=time>fx.situation.finish?1:(time-fx.situation.start)/d;fx.to(pos),time>fx.situation.finish?(fx._plot&&element.plot(new SVG.PointArray(fx._plot.destination).settle()),fx._loop===!0||"number"==typeof fx._loop&&fx._loop>1?("number"==typeof fx._loop&&--fx._loop,fx.animate(d,ease,delay)):fx._after?fx._after.apply(element,[fx]):fx.stop()):requestAnimFrame(fx.render)}else requestAnimFrame(fx.render)},fx.render()},new SVG.Number(delay).valueOf())),this},bbox:function(){return this.target.bbox()},attr:function(a,v){if("object"==typeof a)for(var key in a)this.attr(key,a[key]);else{var from=this.target.attr(a);this.attrs[a]=SVG.Color.isColor(from)?new SVG.Color(from).morph(v):SVG.regex.unit.test(from)?new SVG.Number(from).morph(v):{from:from,to:v}}return this},transform:function(o,v){if(1==arguments.length){o=parseMatrix(o),delete o.matrix;for(v in o)this.trans[v]={from:this.target.trans[v],to:o[v]}}else{var transform={};transform[o]=v,this.transform(transform)}return this},style:function(s,v){if("object"==typeof s)for(var key in s)this.style(key,s[key]);else this.styles[s]={from:this.target.style(s),to:v};return this},x:function(x){return this._x=new SVG.Number(this.target.x()).morph(x),this},y:function(y){return this._y=new SVG.Number(this.target.y()).morph(y),this},cx:function(x){return this._cx=new SVG.Number(this.target.cx()).morph(x),this},cy:function(y){return this._cy=new SVG.Number(this.target.cy()).morph(y),this},move:function(x,y){return this.x(x).y(y)},center:function(x,y){return this.cx(x).cy(y)},size:function(width,height){if(this.target instanceof SVG.Text)this.attr("font-size",width);else{var box=this.target.bbox();this._size={width:new SVG.Number(box.width).morph(width),height:new SVG.Number(box.height).morph(height)}}return this},plot:function(p){return this._plot=p,this},leading:function(value){return this.target._leading&&(this._leading=new SVG.Number(this.target._leading).morph(value)),this},viewbox:function(x,y,width,height){if(this.target instanceof SVG.Container){var box=this.target.viewbox();this._viewbox={x:new SVG.Number(box.x).morph(x),y:new SVG.Number(box.y).morph(y),width:new SVG.Number(box.width).morph(width),height:new SVG.Number(box.height).morph(height)}}return this},update:function(o){return this.target instanceof SVG.Stop&&(null!=o.opacity&&this.attr("stop-opacity",o.opacity),null!=o.color&&this.attr("stop-color",o.color),null!=o.offset&&this.attr("offset",new SVG.Number(o.offset))),this},during:function(during){return this._during=during,this},after:function(after){return this._after=after,this},loop:function(times){return this._loop=times||!0,this},stop:function(fulfill){return fulfill===!0?(this.animate(0),this._after&&this._after.apply(this.target,[this])):(clearTimeout(this.timeout),this.attrs={},this.trans={},this.styles={},this.situation={},delete this._x,delete this._y,delete this._cx,delete this._cy,delete this._size,delete this._plot,delete this._loop,delete this._after,delete this._during,delete this._leading,delete this._viewbox),this},pause:function(){return this.situation.play===!0&&(this.situation.play=!1,this.situation.pause=(new Date).getTime()),this},play:function(){if(this.situation.play===!1){var pause=(new Date).getTime()-this.situation.pause;this.situation.finish+=pause,this.situation.start+=pause,this.situation.play=!0}return this}},parent:SVG.Element,construct:{animate:function(d,ease,delay){return(this.fx||(this.fx=new SVG.FX(this))).stop().animate(d,ease,delay)},stop:function(fulfill){return this.fx&&this.fx.stop(fulfill),this},pause:function(){return this.fx&&this.fx.pause(),this},play:function(){return this.fx&&this.fx.play(),this}}}),SVG.extend(SVG.Element,SVG.FX,{dx:function(x){return this.x((this.target||this).x()+x)},dy:function(y){return this.y((this.target||this).y()+y)},dmove:function(x,y){return this.dx(x).dy(y)}}),["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","mouseenter","mouseleave","touchstart","touchmove","touchleave","touchend","touchcancel"].forEach(function(event){SVG.Element.prototype[event]=function(f){var self=this;return this.node["on"+event]="function"==typeof f?function(){return f.apply(self,arguments)}:null,this}}),SVG.events={},SVG.listeners={},SVG.registerEvent=function(event){SVG.events[event]||(SVG.events[event]=new Event(event))},SVG.on=function(node,event,listener){var l=listener.bind(node.instance||node);SVG.listeners[listener]=l,node.addEventListener(event,l,!1)},SVG.off=function(node,event,listener){node.removeEventListener(event,SVG.listeners[listener],!1),delete SVG.listeners[listener]},SVG.extend(SVG.Element,{on:function(event,listener){return SVG.on(this.node,event,listener),this},off:function(event,listener){return SVG.off(this.node,event,listener),this},fire:function(event){return this.node.dispatchEvent(SVG.events[event]),this}}),SVG.Defs=SVG.invent({create:"defs",inherit:SVG.Container}),SVG.G=SVG.invent({create:"g",inherit:SVG.Container,extend:{x:function(x){return null==x?this.trans.x:this.transform("x",x)},y:function(y){return null==y?this.trans.y:this.transform("y",y)},cx:function(x){return null==x?this.bbox().cx:this.x(x-this.bbox().width/2)},cy:function(y){return null==y?this.bbox().cy:this.y(y-this.bbox().height/2)}},construct:{group:function(){return this.put(new SVG.G)}}}),SVG.extend(SVG.Element,{siblings:function(){return this.parent.children()},position:function(){return this.parent.index(this)},next:function(){return this.siblings()[this.position()+1]},previous:function(){return this.siblings()[this.position()-1]},forward:function(){var i=this.position();return this.parent.removeElement(this).put(this,i+1)},backward:function(){var i=this.position();return i>0&&this.parent.removeElement(this).add(this,i-1),this},front:function(){return this.parent.removeElement(this).put(this)},back:function(){return this.position()>0&&this.parent.removeElement(this).add(this,0),this},before:function(element){element.remove();var i=this.position();return this.parent.add(element,i),this},after:function(element){element.remove();var i=this.position();return this.parent.add(element,i+1),this}}),SVG.Mask=SVG.invent({create:function(){this.constructor.call(this,SVG.create("mask")),this.targets=[]},inherit:SVG.Container,extend:{remove:function(){for(var i=this.targets.length-1;i>=0;i--)this.targets[i]&&this.targets[i].unmask();return delete this.targets,this.parent.removeElement(this),this}},construct:{mask:function(){return this.defs().put(new SVG.Mask)}}}),SVG.extend(SVG.Element,{maskWith:function(element){return this.masker=element instanceof SVG.Mask?element:this.parent.mask().add(element),this.masker.targets.push(this),this.attr("mask",'url("#'+this.masker.attr("id")+'")')},unmask:function(){return delete this.masker,this.attr("mask",null)}}),SVG.Clip=SVG.invent({create:function(){this.constructor.call(this,SVG.create("clipPath")),this.targets=[]},inherit:SVG.Container,extend:{remove:function(){for(var i=this.targets.length-1;i>=0;i--)this.targets[i]&&this.targets[i].unclip();return delete this.targets,this.parent.removeElement(this),this}},construct:{clip:function(){return this.defs().put(new SVG.Clip)}}}),SVG.extend(SVG.Element,{clipWith:function(element){return this.clipper=element instanceof SVG.Clip?element:this.parent.clip().add(element),this.clipper.targets.push(this),this.attr("clip-path",'url("#'+this.clipper.attr("id")+'")')},unclip:function(){return delete this.clipper,this.attr("clip-path",null)}}),SVG.Gradient=SVG.invent({create:function(type){this.constructor.call(this,SVG.create(type+"Gradient")),this.type=type
},inherit:SVG.Container,extend:{from:function(x,y){return this.attr("radial"==this.type?{fx:new SVG.Number(x),fy:new SVG.Number(y)}:{x1:new SVG.Number(x),y1:new SVG.Number(y)})},to:function(x,y){return this.attr("radial"==this.type?{cx:new SVG.Number(x),cy:new SVG.Number(y)}:{x2:new SVG.Number(x),y2:new SVG.Number(y)})},radius:function(r){return"radial"==this.type?this.attr({r:new SVG.Number(r)}):this},at:function(offset,color,opacity){return this.put(new SVG.Stop).update(offset,color,opacity)},update:function(block){return this.clear(),"function"==typeof block&&block.call(this,this),this},fill:function(){return"url(#"+this.attr("id")+")"},toString:function(){return this.fill()}},construct:{gradient:function(type,block){return this.defs().gradient(type,block)}}}),SVG.extend(SVG.Defs,{gradient:function(type,block){return this.put(new SVG.Gradient(type)).update(block)}}),SVG.Stop=SVG.invent({create:"stop",inherit:SVG.Element,extend:{update:function(o){return("number"==typeof o||o instanceof SVG.Number)&&(o={offset:arguments[0],color:arguments[1],opacity:arguments[2]}),null!=o.opacity&&this.attr("stop-opacity",o.opacity),null!=o.color&&this.attr("stop-color",o.color),null!=o.offset&&this.attr("offset",new SVG.Number(o.offset)),this}}}),SVG.Pattern=SVG.invent({create:"pattern",inherit:SVG.Container,extend:{fill:function(){return"url(#"+this.attr("id")+")"},update:function(block){return this.clear(),"function"==typeof block&&block.call(this,this),this},toString:function(){return this.fill()}},construct:{pattern:function(width,height,block){return this.defs().pattern(width,height,block)}}}),SVG.extend(SVG.Defs,{pattern:function(width,height,block){return this.put(new SVG.Pattern).update(block).attr({x:0,y:0,width:width,height:height,patternUnits:"userSpaceOnUse"})}}),SVG.Doc=SVG.invent({create:function(element){this.parent="string"==typeof element?document.getElementById(element):element,this.constructor.call(this,"svg"==this.parent.nodeName?this.parent:SVG.create("svg")),this.attr({xmlns:SVG.ns,version:"1.1",width:"100%",height:"100%"}).attr("xmlns:xlink",SVG.xlink,SVG.xmlns),this._defs=new SVG.Defs,this._defs.parent=this,this.node.appendChild(this._defs.node),this.doSpof=!1,this.parent!=this.node&&this.stage()},inherit:SVG.Container,extend:{stage:function(){var element=this;return this.parent.appendChild(this.node),element.spof(),SVG.on(window,"resize",function(){element.spof()}),this},defs:function(){return this._defs},spof:function(){if(this.doSpof){var pos=this.node.getScreenCTM();pos&&this.style("left",-pos.e%1+"px").style("top",-pos.f%1+"px")}return this},fixSubPixelOffset:function(){return this.doSpof=!0,this}}}),SVG.Shape=SVG.invent({create:function(element){this.constructor.call(this,element)},inherit:SVG.Element}),SVG.Use=SVG.invent({create:"use",inherit:SVG.Shape,extend:{element:function(element){return this.target=element,this.attr("href","#"+element,SVG.xlink)}},construct:{use:function(element){return this.put(new SVG.Use).element(element)}}}),SVG.Rect=SVG.invent({create:"rect",inherit:SVG.Shape,construct:{rect:function(width,height){return this.put((new SVG.Rect).size(width,height))}}}),SVG.Ellipse=SVG.invent({create:"ellipse",inherit:SVG.Shape,extend:{x:function(x){return null==x?this.cx()-this.attr("rx"):this.cx(x+this.attr("rx"))},y:function(y){return null==y?this.cy()-this.attr("ry"):this.cy(y+this.attr("ry"))},cx:function(x){return null==x?this.attr("cx"):this.attr("cx",new SVG.Number(x).divide(this.trans.scaleX))},cy:function(y){return null==y?this.attr("cy"):this.attr("cy",new SVG.Number(y).divide(this.trans.scaleY))},width:function(width){return null==width?2*this.attr("rx"):this.attr("rx",new SVG.Number(width).divide(2))},height:function(height){return null==height?2*this.attr("ry"):this.attr("ry",new SVG.Number(height).divide(2))},size:function(width,height){var p=proportionalSize(this.bbox(),width,height);return this.attr({rx:new SVG.Number(p.width).divide(2),ry:new SVG.Number(p.height).divide(2)})}},construct:{circle:function(size){return this.ellipse(size,size)},ellipse:function(width,height){return this.put(new SVG.Ellipse).size(width,height).move(0,0)}}}),SVG.Line=SVG.invent({create:"line",inherit:SVG.Shape,extend:{x:function(x){var b=this.bbox();return null==x?b.x:this.attr({x1:this.attr("x1")-b.x+x,x2:this.attr("x2")-b.x+x})},y:function(y){var b=this.bbox();return null==y?b.y:this.attr({y1:this.attr("y1")-b.y+y,y2:this.attr("y2")-b.y+y})},cx:function(x){var half=this.bbox().width/2;return null==x?this.x()+half:this.x(x-half)},cy:function(y){var half=this.bbox().height/2;return null==y?this.y()+half:this.y(y-half)},width:function(width){var b=this.bbox();return null==width?b.width:this.attr(this.attr("x1")<this.attr("x2")?"x2":"x1",b.x+width)},height:function(height){var b=this.bbox();return null==height?b.height:this.attr(this.attr("y1")<this.attr("y2")?"y2":"y1",b.y+height)},size:function(width,height){var p=proportionalSize(this.bbox(),width,height);return this.width(p.width).height(p.height)},plot:function(x1,y1,x2,y2){return this.attr({x1:x1,y1:y1,x2:x2,y2:y2})}},construct:{line:function(x1,y1,x2,y2){return this.put((new SVG.Line).plot(x1,y1,x2,y2))}}}),SVG.Polyline=SVG.invent({create:"polyline",inherit:SVG.Shape,construct:{polyline:function(p){return this.put(new SVG.Polyline).plot(p)}}}),SVG.Polygon=SVG.invent({create:"polygon",inherit:SVG.Shape,construct:{polygon:function(p){return this.put(new SVG.Polygon).plot(p)}}}),SVG.extend(SVG.Polyline,SVG.Polygon,{morphArray:SVG.PointArray,plot:function(p){return this.attr("points",this.array=new SVG.PointArray(p,[[0,0]]))},move:function(x,y){return this.attr("points",this.array.move(x,y))},x:function(x){return null==x?this.bbox().x:this.move(x,this.bbox().y)},y:function(y){return null==y?this.bbox().y:this.move(this.bbox().x,y)},width:function(width){var b=this.bbox();return null==width?b.width:this.size(width,b.height)},height:function(height){var b=this.bbox();return null==height?b.height:this.size(b.width,height)},size:function(width,height){var p=proportionalSize(this.bbox(),width,height);return this.attr("points",this.array.size(p.width,p.height))}}),SVG.Path=SVG.invent({create:"path",inherit:SVG.Shape,extend:{plot:function(p){return this.attr("d",this.array=new SVG.PathArray(p,[["M",0,0]]))},move:function(x,y){return this.attr("d",this.array.move(x,y))},x:function(x){return null==x?this.bbox().x:this.move(x,this.bbox().y)},y:function(y){return null==y?this.bbox().y:this.move(this.bbox().x,y)},size:function(width,height){var p=proportionalSize(this.bbox(),width,height);return this.attr("d",this.array.size(p.width,p.height))},width:function(width){return null==width?this.bbox().width:this.size(width,this.bbox().height)},height:function(height){return null==height?this.bbox().height:this.size(this.bbox().width,height)}},construct:{path:function(d){return this.put(new SVG.Path).plot(d)}}}),SVG.Image=SVG.invent({create:"image",inherit:SVG.Shape,extend:{load:function(url){if(!url)return this;var self=this,img=document.createElement("img");return img.onload=function(){var p=self.doc(SVG.Pattern);0==self.width()&&0==self.height()&&self.size(img.width,img.height),p&&0==p.width()&&0==p.height()&&p.size(self.width(),self.height()),"function"==typeof self._loaded&&self._loaded.call(self,{width:img.width,height:img.height,ratio:img.width/img.height,url:url})},this.attr("href",img.src=this.src=url,SVG.xlink)},loaded:function(loaded){return this._loaded=loaded,this}},construct:{image:function(source,width,height){return this.put(new SVG.Image).load(source).size(width||0,height||width||0)}}}),SVG.Text=SVG.invent({create:function(){this.constructor.call(this,SVG.create("text")),this._leading=new SVG.Number(1.3),this._rebuild=!0,this._build=!1,this.attr("font-family",SVG.defaults.attrs["font-family"])},inherit:SVG.Shape,extend:{x:function(x){return null==x?this.attr("x"):(this.textPath||this.lines.each(function(){this.newLined&&this.x(x)}),this.attr("x",x))},y:function(y){var oy=this.attr("y"),o="number"==typeof oy?oy-this.bbox().y:0;return null==y?"number"==typeof oy?oy-o:oy:this.attr("y","number"==typeof y?y+o:y)},cx:function(x){return null==x?this.bbox().cx:this.x(x-this.bbox().width/2)},cy:function(y){return null==y?this.bbox().cy:this.y(y-this.bbox().height/2)},text:function(text){if("undefined"==typeof text)return this.content;if(this.clear().build(!0),"function"==typeof text)text.call(this,this);else{text=(this.content=text).split("\n");for(var i=0,il=text.length;il>i;i++)this.tspan(text[i]).newLine()}return this.build(!1).rebuild()},size:function(size){return this.attr("font-size",size).rebuild()},leading:function(value){return null==value?this._leading:(this._leading=new SVG.Number(value),this.rebuild())},rebuild:function(rebuild){if("boolean"==typeof rebuild&&(this._rebuild=rebuild),this._rebuild){var self=this;this.lines.each(function(){this.newLined&&(this.textPath||this.attr("x",self.attr("x")),this.attr("dy",self._leading*new SVG.Number(self.attr("font-size"))))}),this.fire("rebuild")}return this},build:function(build){return this._build=!!build,this}},construct:{text:function(text){return this.put(new SVG.Text).text(text)},plain:function(text){return this.put(new SVG.Text).plain(text)}}}),SVG.TSpan=SVG.invent({create:"tspan",inherit:SVG.Shape,extend:{text:function(text){return"function"==typeof text?text.call(this,this):this.plain(text),this},dx:function(dx){return this.attr("dx",dx)},dy:function(dy){return this.attr("dy",dy)},newLine:function(){var t=this.doc(SVG.Text);return this.newLined=!0,this.dy(t._leading*t.attr("font-size")).attr("x",t.x())}}}),SVG.extend(SVG.Text,SVG.TSpan,{plain:function(text){return this._build===!1&&this.clear(),this.node.appendChild(document.createTextNode(this.content=text)),this},tspan:function(text){var node=(this.textPath||this).node,tspan=new SVG.TSpan;return this._build===!1&&this.clear(),node.appendChild(tspan.node),tspan.parent=this,this instanceof SVG.Text&&this.lines.add(tspan),tspan.text(text)},clear:function(){for(var node=(this.textPath||this).node;node.hasChildNodes();)node.removeChild(node.lastChild);return this instanceof SVG.Text&&(delete this.lines,this.lines=new SVG.Set,this.content=""),this}}),SVG.registerEvent("rebuild"),SVG.TextPath=SVG.invent({create:"textPath",inherit:SVG.Element,parent:SVG.Text,construct:{path:function(d){for(this.textPath=new SVG.TextPath;this.node.hasChildNodes();)this.textPath.node.appendChild(this.node.firstChild);return this.node.appendChild(this.textPath.node),this.track=this.doc().defs().path(d),this.textPath.parent=this,this.textPath.attr("href","#"+this.track,SVG.xlink),this},plot:function(d){return this.track&&this.track.plot(d),this}}}),SVG.Nested=SVG.invent({create:function(){this.constructor.call(this,SVG.create("svg")),this.style("overflow","visible")},inherit:SVG.Container,construct:{nested:function(){return this.put(new SVG.Nested)}}}),SVG.A=SVG.invent({create:"a",inherit:SVG.Container,extend:{to:function(url){return this.attr("href",url,SVG.xlink)},show:function(target){return this.attr("show",target,SVG.xlink)},target:function(target){return this.attr("target",target)}},construct:{link:function(url){return this.put(new SVG.A).to(url)}}}),SVG.extend(SVG.Element,{linkTo:function(url){var link=new SVG.A;return"function"==typeof url?url.call(link,link):link.to(url),this.parent.put(link).put(this)}});var sugar={stroke:["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"],fill:["color","opacity","rule"],prefix:function(t,a){return"color"==a?t:t+"-"+a}};["fill","stroke"].forEach(function(m){var i,extension={};extension[m]=function(o){if("string"==typeof o||SVG.Color.isRgb(o)||o&&"function"==typeof o.fill)this.attr(m,o);else for(i=sugar[m].length-1;i>=0;i--)null!=o[sugar[m][i]]&&this.attr(sugar.prefix(m,sugar[m][i]),o[sugar[m][i]]);return this},SVG.extend(SVG.Element,SVG.FX,extension)}),SVG.extend(SVG.Element,SVG.FX,{rotate:function(deg,x,y){return this.transform({rotation:deg||0,cx:x,cy:y})},skew:function(x,y){return this.transform({skewX:x||0,skewY:y||0})},scale:function(x,y){return this.transform({scaleX:x,scaleY:null==y?x:y})},translate:function(x,y){return this.transform({x:x,y:y})},matrix:function(m){return this.transform({matrix:m})},opacity:function(value){return this.attr("opacity",value)}}),SVG.extend(SVG.Rect,SVG.Ellipse,SVG.FX,{radius:function(x,y){return this.attr({rx:x,ry:y||x})}}),SVG.extend(SVG.Path,{length:function(){return this.node.getTotalLength()},pointAt:function(length){return this.node.getPointAtLength(length)}}),SVG.extend(SVG.Parent,SVG.Text,SVG.FX,{font:function(o){for(var k in o)"leading"==k?this.leading(o[k]):"anchor"==k?this.attr("text-anchor",o[k]):"size"==k||"family"==k||"weight"==k||"stretch"==k||"variant"==k||"style"==k?this.attr("font-"+k,o[k]):this.attr(k,o[k]);return this}}),SVG.Set=SVG.invent({create:function(){this.clear()},extend:{add:function(){var i,il,elements=[].slice.call(arguments);for(i=0,il=elements.length;il>i;i++)this.members.push(elements[i]);return this},remove:function(element){var i=this.index(element);return i>-1&&this.members.splice(i,1),this},each:function(block){for(var i=0,il=this.members.length;il>i;i++)block.apply(this.members[i],[i,this.members]);return this},clear:function(){return this.members=[],this},has:function(element){return this.index(element)>=0},index:function(element){return this.members.indexOf(element)},get:function(i){return this.members[i]},valueOf:function(){return this.members},bbox:function(){var box=new SVG.BBox;if(0==this.members.length)return box;var rbox=this.members[0].rbox();return box.x=rbox.x,box.y=rbox.y,box.width=rbox.width,box.height=rbox.height,this.each(function(){box=box.merge(this.rbox())}),box}},construct:{set:function(){return new SVG.Set}}}),SVG.SetFX=SVG.invent({create:function(set){this.set=set}}),SVG.Set.inherit=function(){var m,methods=[];for(var m in SVG.Shape.prototype)"function"==typeof SVG.Shape.prototype[m]&&"function"!=typeof SVG.Set.prototype[m]&&methods.push(m);methods.forEach(function(method){SVG.Set.prototype[method]=function(){for(var i=0,il=this.members.length;il>i;i++)this.members[i]&&"function"==typeof this.members[i][method]&&this.members[i][method].apply(this.members[i],arguments);return"animate"==method?this.fx||(this.fx=new SVG.SetFX(this)):this}}),methods=[];for(var m in SVG.FX.prototype)"function"==typeof SVG.FX.prototype[m]&&"function"!=typeof SVG.SetFX.prototype[m]&&methods.push(m);methods.forEach(function(method){SVG.SetFX.prototype[method]=function(){for(var i=0,il=this.set.members.length;il>i;i++)this.set.members[i].fx[method].apply(this.set.members[i].fx,arguments);return this}})},SVG.extend(SVG.Element,{data:function(a,v,r){if("object"==typeof a)for(v in a)this.data(v,a[v]);else if(arguments.length<2)try{return JSON.parse(this.attr("data-"+a))}catch(e){return this.attr("data-"+a)}else this.attr("data-"+a,null===v?null:r===!0||"string"==typeof v||"number"==typeof v?v:JSON.stringify(v));return this}}),SVG.extend(SVG.Element,{remember:function(k,v){if("object"==typeof arguments[0])for(var v in k)this.remember(v,k[v]);else{if(1==arguments.length)return this.memory()[k];this.memory()[k]=v}return this},forget:function(){if(0==arguments.length)this._memory={};else for(var i=arguments.length-1;i>=0;i--)delete this.memory()[arguments[i]];return this},memory:function(){return this._memory||(this._memory={})}}),"function"==typeof define&&define.amd?define(function(){return SVG}):"undefined"!=typeof exports&&(exports.SVG=SVG),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(c){window.setTimeout(c,1e3/60)}}()}).call(this),function(){var root;root="undefined"!=typeof exports&&null!==exports?exports:this,root.Aperture=function(){function Aperture(params){var key,value;for(key in params)value=params[key],this[""+key]=value;this.print()}return Aperture.prototype.print=function(){var p;switch(p="aperture "+this.code+" is a "+this.shape+" with ",this.shape){case"C":p+="dia: "+this.dia;break;case"R":case"O":p+="x size: "+this.sizeX+", y size: "+this.sizeY;break;case"P":p+="circumscribed dia: "+this.dia+", points: "+this.points,null!=this.rotation&&(p+=", rotation: "+this.rotation);break;default:p+="macro stuff"}return void(null!=this.holeX&&(p+=null==this.holeY?", hole dia: "+this.holeX:", hole x size: "+this.holeX+", hole y size "+this.holeY))},Aperture}()}.call(this),function(){var Fill,LayerObject,Pad,PathObject,Trace,root,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};root="undefined"!=typeof exports&&null!==exports?exports:this,LayerObject=function(){function LayerObject(params){var key,value;null==params&&(params={});for(key in params)value=params[key],this[""+key]=value}return LayerObject.prototype.print=function(){var key,value,_results;_results=[];for(key in params)value=params[key],_results.push(void 0);return _results},LayerObject.prototype.draw=function(svgItem){return svgItem.bbox()},LayerObject}(),Pad=function(_super){function Pad(){return Pad.__super__.constructor.apply(this,arguments)}return __extends(Pad,_super),Pad.prototype.print=function(){return void 0},Pad.prototype.draw=function(drawing){var h,m,p,pad;switch(pad=null,this.tool.shape){case"C":pad=drawing.circle(this.tool.dia),pad.center(this.x,this.y);break;case"R":pad=drawing.rect(this.tool.sizeX,this.tool.sizeY),pad.center(this.x,this.y);break;case"O":break;case"P":}return null!=this.tool.holeX&&(p=pad.clone().fill({color:"#fff"}),h=null,h=null!=this.tool.holeY?drawing.rect(this.tool.holeX,this.tool.holeY):drawing.circle(this.tool.holeX),h.center(pad.cx(),pad.cy()).fill({color:"#000"}),m=drawing.mask().add(p).add(h),pad.maskWith(m)),Pad.__super__.draw.call(this,pad)},Pad}(LayerObject),PathObject=function(_super){function PathObject(){return PathObject.__super__.constructor.apply(this,arguments)}return __extends(PathObject,_super),PathObject.prototype.pathArrayToString=function(pathArray){var pathString;return pathString=pathArray.join(" ")},PathObject}(LayerObject),Trace=function(_super){function Trace(){return Trace.__super__.constructor.apply(this,arguments)}return __extends(Trace,_super),Trace.prototype.print=function(){return void 0},Trace.prototype.draw=function(drawing){var path;if(path=this.pathArrayToString(this.pathArray),path=drawing.path(path),null==this.tool.dia)throw"rectangular trace apertures unimplimented in this reader";return path.stroke({width:this.tool.dia,linecap:"round"}),path.fill({color:"transparent"}),Trace.__super__.draw.call(this,path)},Trace.prototype.draw2=function(drawing,origin,canvas){var trace,x1,x2,y1,y2;return trace=null,x1=this.x-origin.x+canvas.margin,x2=this.coord.x-origin.x+canvas.margin,y1=canvas.height-(this.y-origin.y)+canvas.margin,y2=canvas.height-(this.coord.y-origin.y)+canvas.margin,"C"===this.tool.shape?(trace=drawing.line(),trace.stroke({width:""+this.tool.dia,linecap:"round"}),trace.plot(x1,y1,x2,y2)):"R"===this.tool.shape?void 0:void 0},Trace}(PathObject),Fill=function(_super){function Fill(){return Fill.__super__.constructor.apply(this,arguments)}return __extends(Fill,_super),Fill.prototype.draw=function(drawing){var path;return path=this.pathArrayToString(this.pathArray),path=drawing.path(path),path.fill({color:"#000"}).stroke({width:0}),Fill.__super__.draw.call(this,path)},Fill}(PathObject),root.Layer=function(){function Layer(name){this.name=name,this.layerObjects=[],this.minX=null,this.minY=null,this.maxX=null,this.maxY=null}return Layer.prototype.setUnits=function(u){return"in"===u?this.units="in":"mm"===u?this.units="mm":void 0},Layer.prototype.getSize=function(){return[this.minX,this.maxX,this.minY,this.maxY]},Layer.prototype.addTrace=function(params){var t;if("C"!==params.tool.shape&&"R"!==params.tool.shape)throw"cannot create trace with "+tool.shape+" (tool "+tool.code+")";if(null!=params.tool.holeX)throw"cannot create trace with a holed tool (tool "+tool.code+")";return t=new Trace(params),this.layerObjects.push(t)},Layer.prototype.addPad=function(params){var p;return p=new Pad(params),this.layerObjects.push(p)},Layer.prototype.addFill=function(params){var f;return f=new Fill(params),this.layerObjects.push(f)},Layer.prototype.draw=function(id){var box,group,o,svg,_i,_len,_ref;for(svg=SVG(id),group=svg.group(),_ref=this.layerObjects,_i=0,_len=_ref.length;_len>_i;_i++)o=_ref[_i],o.draw(group);return box=group.bbox(),svg.size(""+box.width+this.units,""+box.height+this.units).viewbox(0,0,box.width,box.height),group.transform({x:-box.x,y:box.y2,scaleY:-1}),svg},Layer}()}.call(this),function(){var root;root="undefined"!=typeof exports&&null!==exports?exports:this,root.Plotter=function(){function Plotter(gerber,name){this.gerber=gerber,this.name=name,this.index=0,this.line=1,this.end=!1,this.layer=new Layer(this.name),this.format={set:!1,zero:null,notation:null,"int":null,dec:null},this.units=null,this.tools={},this.polarity="D",this.tool=null,this.position={x:0,y:0},this.mode={"int":null,quad:null,region:!1},this.path={current:null,startX:null,startY:null}}return Plotter.prototype.plot=function(){for(var block,next;!(this.end||this.index>=this.gerber.length);)if(next=this.gerber[this.index],"%"===next)this.readParameter();else for(block=this.readBlock();block.length>0;)block.match(/^M0?2$/)?(this.end=!0,block=""):block=block.match(/^G[01234579][0-7]?/)?this.processState(block):block.match(/D[0-9]\d*$/)?this.operate(block):"";return this.finishPath(),this.layer.setUnits(this.units),this.layer},Plotter.prototype.processState=function(command){var g;if(g=command.match(/^G[01234579][0-7]?/),null==g)throw"error: "+command+" is not a valid state command";switch(g=g[0]){case"G1":case"G01":this.mode.int=1;break;case"G2":case"G02":this.mode.int=2;break;case"G3":case"G03":this.mode.int=3;break;case"G4":case"G04":command="";break;case"G36":this.mode.region=!0;break;case"G37":this.finishPath(),this.mode.region=!1;break;case"G74":this.mode.quad=74;break;case"G75":this.mode.quad=75;break;case"G54":case"G55":case"G70":case"G71":case"G90":case"G91":break;default:throw"error at "+this.line+": "+g+" is unrecognized"}return command.length>g.length?command.slice(g.length):""},Plotter.prototype.operate=function(command){var d;if(d=command.match(/D[0-9]\d*$/),null==d)throw"error: "+command+" is not a valid operation command";switch(d=d[0]){case"D1":case"D01":this.interpolate(this.getCoordinates(command));break;case"D2":case"D02":this.move(this.getCoordinates(command));break;case"D3":case"D03":this.flash(this.getCoordinates(command));break;default:this.changeTool(d)}return""},Plotter.prototype.getCoordinates=function(command){var c;return c={},c.x=command.match(/X[+-]?\d+/),c.x=null!=c.x?this.parseCoordinate(c.x[0].slice(1)):this.position.x,c.y=command.match(/Y[+-]?\d+/),c.y=null!=c.y?this.parseCoordinate(c.y[0].slice(1)):this.position.y,c.i=command.match(/I[+-]?\d+/),null!=c.i?c.i=this.parseCoordinate(c.i[0].slice(1)):1!==this.mode.int&&(c.i=0),c.j=command.match(/J[+-]?\d+/),null!=c.j?c.j=this.parseCoordinate(c.j[0].slice(1)):1!==this.mode.int&&(c.j=0),c},Plotter.prototype.parseCoordinate=function(coord){var negative,sign;if(negative=!1,sign="+",("-"===coord[0]||"+"===coord[0])&&(sign=coord[0],coord=coord.slice(1)),"L"===this.format.zero){for(;coord.length<=this.format.dec;)coord="0"+coord;coord=coord.slice(0,-this.format.dec)+"."+coord.slice(-this.format.dec)}else if("T"===this.format.zero){for(;coord.length<=this.format.int+1;)coord=0;coord=coord.slice(0,this.format.int)+"."+coord.slice(this.format.int)}return coord=parseFloat(sign+coord)},Plotter.prototype.finishPath=function(){if(null!=this.path.current){if(this.mode.region===!1)this.layer.addTrace({tool:this.tool,pathArray:this.path.current});else{if(!(abs(this.position.x-this.path.startX)<1e-7&&abs(this.position.y-this.path.startY)<1e-7))throw"error at "+this.line+": region close command on open contour";this.path.current.push("Z"),this.layer.addFill({pathArray:this.path.current}),this.path.startX=null,this.path.startY=null}return this.path.current=null}},Plotter.prototype.interpolate=function(c){var cenX,largeArcFlag,r,sweepFlag,theta,xAxisRot;if(null==this.path.current&&(this.path.current=["M",this.position.x,this.position.y],this.path.startX=this.position.x,this.path.startY=this.position.y),1===this.mode.int)this.path.current.push("L",c.x,c.y);else{if(2!==this.mode.int&&3!==this.mode.int)throw"error at #@{line}: interpolation command without setting mode with G1/2/3";if("C"!==this.tool.shape||null!=this.tool.holeX)throw"error at "+this.line+": arcs may only be drawn with a solid circular aperture";r=Math.sqrt(Math.pow(c.i,2)+Math.pow(c.j,2)),xAxisRot=0,sweepFlag=this.mode.int-2,largeArcFlag=0,75===this.mode.quad&&(cenX=this.position.x+c.i,theta=Math.acos((c.x-cenX)/r),theta>=Math.PI&&(largeArcFlag=1),Math.abs(this.position.x-c.x)<1e-6&&Math.abs(this.position.y-c.y)<1e-6&&this.path.current.push("A",r,r,xAxisRot,largeArcFlag,sweepFlag,c.x+2*c.i,c.y+2*c.j)),this.path.current.push("A",r,r,xAxisRot,largeArcFlag,sweepFlag,c.x,c.y)}return this.moveTo(c)},Plotter.prototype.move=function(c){return this.finishPath(),this.moveTo(c)},Plotter.prototype.moveTo=function(c){return this.position.x=c.x,void(this.position.y=c.y)},Plotter.prototype.flash=function(c){if(this.mode.region===!0)throw"error at "+this.line+": cannot flash (D03) in region mode";if(null==this.tool)throw"error at "+this.line+": no tool selected for flash";return this.layer.addPad({tool:this.tool,x:c.x,y:c.y}),this.moveTo(c)},Plotter.prototype.readBlock=function(){var block;for(block="";"*"!==this.gerber[this.index];)"\n"===this.gerber[this.index]?this.line++:block+=this.gerber[this.index],this.index++;for(;"*"===this.gerber[this.index]||"\n"===this.gerber[this.index]||"\r"===this.gerber[this.index];)"\n"===this.gerber[this.index]&&this.line++,this.index++;return block},Plotter.prototype.readParameter=function(){var block,c,command,param,_results;for(c="";"%"!==c;){switch(block=this.readBlock(),param=block.slice(1,3),command=block.slice(3),param){case"FS":this.setFormat(command);break;case"MO":this.setUnitMode(command);break;case"AD":this.createTool(command);break;case"AM":break;case"SR":break;case"LP":this.setPolarity}c=this.gerber[this.index]}for(this.index++,_results=[];"\n"===this.gerber[this.index]||"\r"===this.gerber[this.index];)"\n"===this.gerber[this.index]&&this.line++,_results.push(this.index++);return _results},Plotter.prototype.setFormat=function(command){var notation,xFormat,yFormat,zero;if(this.format.set)throw"error at "+line+": format has already been set";if(zero=command[0],"L"!==zero&&"T"!==zero)throw""+zero+" at line "+this.line+" is invalid zero omission value (L or T)";if(this.format.zero=zero,notation=command[1],"A"!==notation&&"I"!==notation)throw""+notation+" at line "+this.line+" is invalid notation value (A or I)";if(this.format.notation=notation,xFormat=command.slice(2,5),yFormat=command.slice(5,8),"X"!==xFormat[0])throw"error at "+line+": "+xFormat[0]+" is not a valid coordinate";if("Y"!==yFormat[0])throw"error at "+line+": "+yFormat[0]+" is not a valid coordinate";if(xFormat.slice(1)!==yFormat.slice(1))throw"error at "+line+": x format and y format don't match";if(this.format.int=parseInt(xFormat[1],10),this.format.dec=parseInt(xFormat[2],10),this.format.int>7)throw"error at "+line+": "+this.format.int+" exceeds max interger places of 7";if(this.format.dec>7)throw"error at "+line+": "+this.format.dec+" exceeds max decimal places of 7";return this.format.set=!0},Plotter.prototype.setUnitMode=function(command){if(null!=this.units)throw"error at "+this.line+": unit mode has already been set";if("IN"===command)this.units="in";else{if("MM"!==command)throw"#error at "+this.line+": "+command+" is not a valid unit mode (IN or MM)";this.units="mm"}return void 0},Plotter.prototype.setPolarity=function(command){if("C"===command||"D"===command)return this.polarity=command,this.position.x=null,this.position.y=null;throw"error at "+this.line+": "+command+" is not a valid polarity (C or D)"},Plotter.prototype.changeTool=function(code){if(this.mode.region===!0)throw"error at "+this.line+": cannot change tool (Dnn) in region mode";if(null==this.tools[code])throw"error at "+this.line+": tool "+code+" does not exist";return this.finishPath(),void(this.tool=this.tools[code])},Plotter.prototype.createTool=function(command){var tool,toolCode,toolParams,toolShape;if(toolCode=command.slice(0,3),!toolCode.match(/D[1-9]\d+/))throw"error at "+this.line+": "+toolCode+" is not a valid tool number";if(null!=this.tools[toolCode])throw"error at "+this.line+": "+toolCode+" already exists";switch(toolShape=command.slice(3,5),toolParams=command.slice(5),toolShape){case"C,":toolParams=this.getCircleToolParams(toolParams);break;case"R,":toolParams=this.getRectToolParams(toolParams);break;case"O,":toolParams=this.getRectToolParams(toolParams);break;case"P,":toolParams=this.getPolyToolParams(toolParams)}return toolParams.code=toolCode,toolParams.shape=toolShape[0],tool=new Aperture(toolParams),this.tools[toolCode]=tool,this.changeTool(toolCode)},Plotter.prototype.getCircleToolParams=function(command){var numbers,params,_ref;if(numbers=this.gatherToolParams(command),!(1<=(_ref=numbers.length)&&3>=_ref))throw"error at "+line+": circle aperture must have between 1 and 3 params";if(!(numbers[0]>=0))throw"error at "+line+": circle dia must be greater than or equal to 0";if(params={dia:numbers[0]},null!=numbers[1]){if(!(numbers[1]>=0))throw"error at "+line+": hole x size must be greater than or equal to 0";params.holeX=numbers[1]}if(null!=numbers[2]){if(!(numbers[2]>=0))throw"error at "+line+": hole y size must be greater than or equal to 0";params.holeY=numbers[2]}return params},Plotter.prototype.getRectToolParams=function(command){var numbers,params,_ref;if(numbers=this.gatherToolParams(command),!(2<=(_ref=numbers.length)&&4>=_ref))throw"error at "+line+": rect/obround aperture must have between 2 and 4 params";if(!(numbers[0]>0))throw"error at "+line+": rect/obround x size must be greater than 0";if(!(numbers[1]>0))throw"error at "+line+": rect/obround y size must be greater than 0";if(params={sizeX:numbers[0],sizeY:numbers[1]},null!=numbers[2]){if(!(numbers[2]>=0))throw"error at "+line+": hole x size must be greater than or equal to 0";params.holeX=numbers[2]}if(null!=numbers[3]){if(!(numbers[3]>=0))throw"error at "+line+": hole y size must be greater than or equal to 0";params.holeY=numbers[3]}return params},Plotter.prototype.getPolyToolParams=function(command){var numbers,params,_ref,_ref1;if(numbers=gatherToolParams(command),!(2<=(_ref=numbers.length)&&5>=_ref))throw"error at "+line+": polygon aperture must have between 2 and 4 params";if(!(numbers[0]>0))throw"error at "+line+": polygon diameter must be greater than 0";if(!(3<=(_ref1=numbers[1])&&12>=_ref1))throw"error at "+line+": polygon must have 3 to 12 points";if(params={dia:numbers[0],points:numbers[1]},null!=numbers[2]&&(params.rotation=numbers[2]),null!=numbers[3]){if(!(numbers[3]>=0))throw"error at "+line+": hole x size must be greater than or equal to 0";params.holeY=numbers[3]}if(null!=numbers[4]){if(!(numbers[4]>=0))throw"error at "+line+": hole y size must be greater than or equal to 0";params.holeY=numbers[4]}return params},Plotter.prototype.gatherToolParams=function(command){var i,n,numbers,_i,_len;for(numbers=command.match(/[\+-]?[\d\.]+(?=X|$)/g),i=_i=0,_len=numbers.length;_len>_i;i=++_i){if(n=numbers[i],!n.match(/^[\+-]?((\d+\.?\d*)|(\d*\.?\d+))$/))throw"error at "+line+": "+n+" is not a valid number";numbers[i]=parseFloat(n)}return numbers},Plotter}()}.call(this),function(){var fileToSVG,handleFileSelect,readFileToDiv;fileToSVG=function(file,filename){var layer,p;
return p=new Plotter(file,filename.slice(-3)),layer=p.plot()},readFileToDiv=function(event,filename){var drawDiv,imgsrc,layer,svg,svg64;return event.target.readyState===FileReader.DONE?(layer=fileToSVG(event.target.result,filename),drawDiv=document.createElement("div"),drawDiv.innerHTML="<h3>"+filename+"</h3>",drawDiv.id="layer-"+layer.name,drawDiv["class"]="layer-div",document.getElementById("layers").insertBefore(drawDiv,null),svg=layer.draw(drawDiv.id),svg64=btoa(svg.node.outerHTML),imgsrc="data:image/svg+xml;base64,"+svg64,drawDiv.innerHTML+="<a download='filename' href-lang='image/svg+xml' href='"+imgsrc+"'>download svg</a>"):void 0},handleFileSelect=function(event){var f,importFiles,output,_i,_j,_len,_len1,_results;for(importFiles=event.target.files,output=[],_i=0,_len=importFiles.length;_len>_i;_i++)f=importFiles[_i],output.push("<li><strong>",escape(f.name),"</li>");for(document.getElementById("list").innerHTML="<ul>"+output.join("")+"</ul>",_results=[],_j=0,_len1=importFiles.length;_len1>_j;_j++)f=importFiles[_j],_results.push(function(f){var reader;return reader=new FileReader,reader.onloadend=function(event){return readFileToDiv(event,f.name)},reader.readAsText(f)}(f));return _results},document.getElementById("files").addEventListener("change",handleFileSelect,!1)}.call(this);